Pumpkin Seed Binary Classification

## Problem Description

Dataset Abstract: Pumpkin seeds are frequently consumed as confection worldwide because of their adequate amount of protein, fat, carbohydrate, and mineral contents. This study was carried out on the two most important and quality types of pumpkin seeds, ‘‘Urgup_Sivrisi’’ and ‘‘Cercevelik’’, generally grown in Urgup and Karacaoren regions in Turkey. However, morphological measurements of 2500 pumpkin seeds of both varieties were made possible by using the gray and binary forms of threshold techniques. Considering morphological features, all the data were modeled with five different machine learning methods: Logistic Regression (LR), Multilayer Perceptrons (MLP), Support Vector Machine (SVM) and Random Forest (RF), and k-Nearest Neighbor (k-NN), which further determined the most successful method for classifying pumpkin seed varieties. However, the performances of the models were determined with the help of the 10 kfold cross-validation method. The accuracy rates of the classifiers were obtained as LR 87.92 percent, MLP 88.52 percent, SVM 88.64 percent, RF 87.56 percent, and k-NN 87.64 percent.

The morphological measurements of the 2500 pumpkin seeds were used to develop a model to differentiate between the two pumpkin species. 


The list of features provided in the dataset:
- area
- perimeter
- major_axis_length
- minor_axis_length
- convex_area
- equiv_diameter
- eccentricity
- solidity
- extent
- roundness
- aspect_ration
- compactness

The objective of this project is to develop an application that returns the determination of pumpkin seed species based on provided morphological measurements.

## Dataset Source

https://www.kaggle.com/datasets/muratkokludataset/pumpkin-seeds-dataset/data

The dataset is provided with and .xlsx and .arff file formats. The .xlsx file was used for this project to avoid complications with decoding the data for use with Numpy.

## Files

A) notebook.ipnyb: This notebook was used for preparing and cleaning data, exploratory data analysis, as well as model selection and parameter tuning.

B) train.py: The train script performs the essential data preparation steps needed to build the selected model. The target classes 'Çerçevelik' & 'Ürgüp Sivrisi' are mapped to classes 0 and 1 respectively as needed for the model training process. The prepared model is saved as a pickle output file for use by the prediction service.

C) predict.py: The predict file creates the flask web service used to recieve queries, preproccess the data, and provide a response prediction. 

D) predict-test.py: The predict-test script is used to test if the predict.py service is functioning properly.

E) std.npy/mean.npy: Used to store sklearn StandardScaler() scaling data used for training dataset, which is utilized by the predict.py script for scaling data. These   files are generated by the train.py script.


## Instructions to Run

Note: pipenv and Docker needed to execute all of the functions of this project.

1. Clone github repo:

```bash
git clone repo name
```

1. Navigate to the cloned repo directory in a terminal window.

1. Install dependencies to run files.

If running locally, use pipenv to ensure all required dependencies are installed.
```bash
pipenv install
```
1. Run the train.py script to generate the model used for predictions.

```bash
python pipenv run python train.py
```

1. Run the predict.py application:

- Option A: Run locally with gunicorn
```bash
pipenv run gunicorn --bind 0.0.0.0:9696 predict:app
```
- Option B: Run with Docker

```bash
# Build 
docker build -t seed-prediction .

# Run
docker run -it --rm -p 9696:9696 seed-prediction:latest
```

1. Run predict-test.py in another terminal window

```bash
python predict-test.py
```
